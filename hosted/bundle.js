(()=>{var e={867:e=>{let t,o,n=!1;const a=e=>{const t={};return t.x=e.pageX-e.target.offsetLeft,t.y=e.pageY-e.target.offsetTop,t},r=e=>{n=!0;const t=a(e);o.beginPath(),o.moveTo(t.x,t.y)},i=e=>{if(!n)return!1;const t=a(e);return o.lineTo(t.x,t.y),o.stroke(),!0},c=()=>{n=!1,o.closePath()},s=()=>{n=!1,o.closePath()};e.exports={init:()=>(t=document.querySelector("#drawingBoard"),!!(t.getContext&&t.getContext("2d")&&t.toDataURL&&t.toDataURL())&&(o=t.getContext("2d"),t.onmousedown=r,t.onmousemove=i,t.onmouseup=c,t.onmouseout=s,o.lineWidth=3,o.strokeStyle="black",o.lineCap="round",o.lineJoin="round",!0)),setPenColor:e=>{o.strokeStyle=e},toDataURL:()=>t.toDataURL(),drawImage:async e=>{const t=await(e=>new Promise(((t,o)=>{const n=new Image;n.crossOrigin="Anonymous",n.src=e,n.onload=()=>{t(n)},n.onerror=e=>{o(e)}})))(e);o.drawImage(t,0,0)}}}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}(()=>{const e=o(867);let t,n,a,r={};const i=e=>{r[e]&&Object.keys(r).forEach((t=>{r[t].classList.toggle("activeScreen",t===e)}))},c=async e=>{const t=await fetch(`/getGame?code=${n}`,{method:"get",headers:{Accept:"application/json"}}),o=await t.json();return 200===t.status&&o.state===e?o:new Promise((t=>{setTimeout((()=>t(c(e))),1e3)}))};window.onload=()=>{r={start:document.querySelector("#startScreen"),displayCode:document.querySelector("#displayCodeScreen"),inputCode:document.querySelector("#inputCodeScreen"),waiting:document.querySelector("#waitingScreen"),drawing:document.querySelector("#drawingScreen"),noCanvas:document.querySelector("#noCanvasScreen")};const o=document.querySelector("#newGameButton"),s=document.querySelector("#joinGameButton"),d=document.querySelector("#codeDisplay"),l=document.querySelector("#codeInput"),u=document.querySelector("#submitJoinCodeButton"),m=document.querySelector("#joinError"),g=document.querySelector("#whyAmIWaiting"),w=document.querySelector("#whatAmIDrawing"),y=document.querySelector("#submitDrawingButton");e.init()||i("noCanvas"),o.onclick=async()=>{o.disabled=!0;const r=await fetch("/newGame",{method:"post",headers:{Accept:"application/json"}}),s=await r.json();201===r.status?(n=s.code,d.innerHTML=`Tell Player 2 to join with code: ${n}`,i("displayCode"),({player1Scribbles:a}=await c(1)),t=a,g.innerHTML="Waiting for the other player to make a scribble...",w.innerHTML="Make a scribble!",i(t?"drawing":"waiting"),t||(await c(2),await e.drawImage(`/getDrawing?code=${n}`),i("drawing"))):(o.disabled=!1,d.innerHTML=s.message)},s.onclick=()=>{i("inputCode")};const p=async()=>{u.disabled=!0,l.disabled=!0,n=l.value.toUpperCase();const o=await fetch(`/joinGame?code=${n}`,{method:"post",headers:{Accept:"application/json"}}),r=await o.json();200===o.status?(({player1Scribbles:a}=r),t=!a,g.innerHTML="Waiting for the other player to make a scribble...",w.innerHTML="Make a scribble!",i(t?"drawing":"waiting"),t||(await c(2),await e.drawImage(`/getDrawing?code=${n}`),i("drawing"))):(u.disabled=!1,l.disabled=!1,m.innerHTML=r.message)};u.onclick=p,l.onkeypress=e=>{"Enter"===(e.code||e.key)&&p()},y.onclick=async()=>{const o=e.toDataURL();await fetch(`/submitDrawing?code=${n}`,{method:"post",headers:{Accept:"application/json","Content-Type":"image/png"},body:o}),t&&(g.innerHTML="Waiting for the other player to exPENd your scribble...",i("waiting"))}}})()})();