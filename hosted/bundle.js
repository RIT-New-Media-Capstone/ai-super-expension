(()=>{var e={867:e=>{let t,o,n=!1;const a=e=>{const t={};return t.x=e.pageX-e.target.offsetLeft,t.y=e.pageY-e.target.offsetTop,t},r=e=>{n=!0;const t=a(e);o.beginPath(),o.moveTo(t.x,t.y)},i=e=>{if(!n)return!1;const t=a(e);return o.lineTo(t.x,t.y),o.stroke(),!0},c=()=>{n=!1,o.closePath()},s=()=>{n=!1,o.closePath()};e.exports={init:()=>(t=document.querySelector("#drawingBoard"),!!(t.getContext&&t.getContext("2d")&&t.toDataURL&&t.toDataURL())&&(o=t.getContext("2d"),t.onmousedown=r,t.onmousemove=i,t.onmouseup=c,t.onmouseout=s,o.lineWidth=3,o.strokeStyle="black",o.lineCap="round",o.lineJoin="round",!0)),setPenColor:e=>{o.strokeStyle=e},toDataURL:()=>t.toDataURL(),drawImage:(e,t,n)=>{const a=new Image;a.onload=()=>{o.drawImage(a,t,n)},a.src=e}}}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}(()=>{const e=o(867);let t,n,a,r={};const i=e=>{r[e]&&Object.keys(r).forEach((t=>{r[t].classList.toggle("activeScreen",t===e)}))},c=async e=>{const t=await fetch(`/getGame?code=${n}`,{method:"get",headers:{Accept:"application/json"}}),o=await t.json();return 200===t.status&&o.state===e?o:new Promise((t=>{setTimeout((()=>t(c(e))),1e3)}))};window.onload=()=>{r={start:document.querySelector("#startScreen"),displayCode:document.querySelector("#displayCodeScreen"),inputCode:document.querySelector("#inputCodeScreen"),waiting:document.querySelector("#waitingScreen"),drawing:document.querySelector("#drawingScreen"),noCanvas:document.querySelector("#noCanvasScreen")};const o=document.querySelector("#newGameButton"),s=document.querySelector("#joinGameButton"),d=document.querySelector("#codeDisplay"),u=document.querySelector("#codeInput"),l=document.querySelector("#submitJoinCodeButton"),m=document.querySelector("#joinError"),y=document.querySelector("#whyAmIWaiting"),p=document.querySelector("#whatAmIDrawing"),g=document.querySelector("#submitDrawingButton");e.init()||i("noCanvas"),o.onclick=async()=>{o.disabled=!0;const e=await fetch("/newGame",{method:"post",headers:{Accept:"application/json"}}),r=await e.json();201===e.status?(n=r.code,d.innerHTML=`Tell Player 2 to join with code: ${n}`,i("displayCode"),({player1Scribbles:a}=await c(1)),t=a,y.innerHTML="Waiting for the other player to make a scribble...",p.innerHTML="Make a scribble!",i(t?"drawing":"waiting"),t||await c(2)):(o.disabled=!1,d.innerHTML=r.message)},s.onclick=()=>{i("inputCode")},l.onclick=async()=>{l.disabled=!0,n=u.value.toUpperCase();const e=await fetch(`/joinGame?code=${n}`,{method:"post",headers:{Accept:"application/json"}}),o=await e.json();200===e.status?(({player1Scribbles:a}=o),t=!a,y.innerHTML="Waiting for the other player to make a scribble...",p.innerHTML="Make a scribble!",i(t?"drawing":"waiting"),t||await c(2)):(l.disabled=!1,m.innerHTML=o.message)},g.onclick=async()=>{const o=e.toDataURL();await fetch(`/submitDrawing?code=${n}`,{method:"post",headers:{"Content-Type":"image/png"},body:o}),t&&(y.innerHTML="Waiting for the other player to exPENd your scribble...",i("waiting"))}}})()})();